<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FishingPro Store - Perlengkapan Mancing Eksklusif</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #1e3c72;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo::before {
            content: "üé£";
            font-size: 2rem;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 25px;
        }

        .nav-links a:hover {
            color: #1e3c72;
            background: rgba(30, 60, 114, 0.1);
        }

        .cart-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 1.5rem;
            color: #1e3c72;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4757;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .user-info {
            display: none;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: #1e3c72;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        .btn {
            padding: 0.7rem 1.5rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: #1e3c72;
            color: white;
        }

        .btn-primary:hover {
            background: #0f2142;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            color: #1e3c72;
            border: 2px solid #1e3c72;
        }

        .btn-secondary:hover {
            background: #1e3c72;
            color: white;
        }

        .btn-add-cart {
            background: #27ae60;
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            width: 100%;
            margin-top: 1rem;
        }

        .btn-add-cart:hover {
            background: #219a52;
        }

        /* Profile Modal Styles */
        .profile-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .profile-stat {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
        }

        .profile-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e3c72;
        }

        .profile-stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        /* Order History */
        .order-history {
            margin-top: 2rem;
        }

        .order-item {
            border: 1px solid #eee;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .order-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .order-date {
            color: #666;
            font-size: 0.9rem;
        }

        .order-status {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .order-status.completed {
            background: #d4edda;
            color: #155724;
        }

        .order-status.processing {
            background: #fff3cd;
            color: #856404;
        }

        .order-status.shipped {
            background: #cce5ff;
            color: #0066cc;
        }

        .order-status.delivered {
            background: #d1ecf1;
            color: #0c5460;
        }

        .order-products {
            margin-top: 0.5rem;
            color: #666;
        }

        .order-total {
            font-weight: bold;
            color: #27ae60;
            margin-top: 0.5rem;
        }

        .order-resi {
            color: #666;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        /* Order Detail Modal */
        .order-detail-modal .modal-content {
            max-width: 900px;
        }

        .order-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #eee;
        }

        .order-detail-info {
            margin-bottom: 2rem;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .info-label {
            font-weight: bold;
            color: #666;
        }

        /* Tracking Timeline */
        .tracking-timeline {
            margin: 2rem 0;
        }

        .timeline-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1.5rem;
            position: relative;
        }

        .timeline-item:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 15px;
            top: 35px;
            bottom: -20px;
            width: 2px;
            background: #ddd;
            z-index: 1;
        }

        .timeline-item.active::after {
            background: #27ae60;
        }

        .timeline-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            z-index: 2;
            position: relative;
            background: #ddd;
            color: white;
            font-size: 0.8rem;
        }

        .timeline-icon.active {
            background: #27ae60;
        }

        .timeline-icon.current {
            background: #1e3c72;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .timeline-content {
            flex: 1;
        }

        .timeline-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 0.3rem;
        }

        .timeline-description {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
        }

        .timeline-date {
            color: #999;
            font-size: 0.8rem;
        }

        /* Shipping Info */
        .shipping-info {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .shipping-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 1rem;
        }

        .estimate-delivery {
            background: #e7f3ff;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid #007bff;
        }

        .estimate-title {
            font-weight: bold;
            color: #007bff;
            margin-bottom: 0.5rem;
        }

        .estimate-date {
            font-size: 1.1rem;
            color: #333;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 200;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            overflow-y: auto;
            padding: 2rem 1rem;
            align-items: flex-start;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            width: 100%;
            max-width: 600px;
            margin: auto;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease-out;
            max-height: 90vh;
            overflow-y: auto;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .modal-title {
            font-size: 1.5rem;
            color: #1e3c72;
            margin-bottom: 0.5rem;
        }

        .modal-subtitle {
            color: #666;
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: #333;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #1e3c72;
        }

        .form-input.error {
            border-color: #ff4757;
        }

        .error-message {
            color: #ff4757;
            font-size: 0.8rem;
            margin-top: 0.3rem;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .modal-footer {
            margin-top: 2rem;
        }

        .modal-switch {
            text-align: center;
            margin-top: 1rem;
            color: #666;
        }

        .modal-switch a {
            color: #1e3c72;
            text-decoration: none;
            font-weight: 500;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        /* Payment Modal */
        .payment-modal .modal-content {
            max-width: 800px;
        }

        .payment-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 2px solid #eee;
            border-radius: 15px;
        }

        .payment-section.active {
            border-color: #1e3c72;
            background: rgba(30, 60, 114, 0.05);
        }

        .payment-title {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: #1e3c72;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .payment-method {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 10px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .payment-method:hover {
            background: #f8f9fa;
        }

        .payment-method.selected {
            border-color: #1e3c72;
            background: rgba(30, 60, 114, 0.1);
        }

        .payment-icon {
            font-size: 1.5rem;
        }

        .order-summary {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.5rem 0;
        }

        .summary-total {
            border-top: 2px solid #ddd;
            padding-top: 1rem;
            font-weight: bold;
            font-size: 1.2rem;
            color: #27ae60;
        }

        /* Hero Section */
        .hero {
            padding: 4rem 0;
            text-align: center;
            color: white;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .search-bar {
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            background: white;
            border-radius: 50px;
            padding: 0.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .search-bar input {
            flex: 1;
            border: none;
            padding: 1rem 1.5rem;
            font-size: 1rem;
            border-radius: 50px;
            outline: none;
        }

        .search-bar button {
            background: #1e3c72;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 500;
        }

        /* Main Content */
        .main-content {
            background: white;
            margin: 2rem 0;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .content-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }

        .tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            background: white;
            border-bottom-color: #1e3c72;
            color: #1e3c72;
        }

        .tab-content {
            padding: 2rem;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Product Cards */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            cursor: pointer;
            border: 1px solid #eee;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .product-image {
            height: 200px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff4757;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .product-badge.premium {
            background: #ffa502;
        }

        .product-badge.exclusive {
            background: #7bed9f;
            color: #333;
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .product-brand {
            color: #1e3c72;
            font-weight: 500;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .product-description {
            color: #666;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .product-price {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .price-current {
            font-size: 1.3rem;
            font-weight: bold;
            color: #27ae60;
        }

        .price-original {
            text-decoration: line-through;
            color: #999;
            font-size: 1rem;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #ffa500;
            margin-bottom: 1rem;
        }

        /* Category Filter */
        .category-filter {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #1e3c72;
            background: transparent;
            color: #1e3c72;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: #1e3c72;
            color: white;
        }

        /* Featured Section */
        .featured-section {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            text-align: center;
        }

        .featured-title {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .featured-description {
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        /* Cart Section */
        .cart-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid #eee;
        }

        .cart-item-image {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-title {
            font-weight: bold;
            margin-bottom: 0.3rem;
        }

        .cart-item-price {
            color: #27ae60;
            font-weight: bold;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quantity-btn {
            background: #1e3c72;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cart-total {
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .total-final {
            font-size: 1.2rem;
            font-weight: bold;
            color: #27ae60;
            border-top: 1px solid #ddd;
            padding-top: 0.5rem;
        }

        /* Footer */
        footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 2rem 0;
            text-align: center;
            color: #666;
            margin-top: 2rem;
        }

        /* Success Message */
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border: 1px solid #c3e6cb;
            display: none;
        }

        /* Product Detail Styles */
        .product-detail {
            display: none;
            padding: 2rem;
            background: white;
            border-radius: 20px;
            margin-top: 2rem;
        }

        .product-detail.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .product-detail-container {
            display: flex;
            gap: 2rem;
        }

        .product-detail-gallery {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .product-main-image {
            height: 400px;
            background: #f8f9fa;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            overflow: hidden;
        }

        .product-thumbnails {
            display: flex;
            gap: 1rem;
        }

        .product-thumbnail {
            width: 80px;
            height: 80px;
            background: #f8f9fa;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .product-thumbnail:hover {
            border: 2px solid #1e3c72;
        }

        .product-thumbnail.active {
            border: 2px solid #1e3c72;
        }

        .product-detail-info {
            flex: 1;
        }

        .product-detail-title {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .product-detail-brand {
            color: #1e3c72;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .product-detail-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: #ffa500;
        }

        .product-detail-price {
            margin-bottom: 1.5rem;
        }

        .product-detail-current {
            font-size: 1.8rem;
            font-weight: bold;
            color: #27ae60;
        }

        .product-detail-original {
            text-decoration: line-through;
            color: #999;
            font-size: 1.2rem;
            margin-left: 0.5rem;
        }

        .product-detail-discount {
            background: #ff4757;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 5px;
            font-size: 0.9rem;
            margin-left: 0.5rem;
        }

        .product-detail-description {
            margin-bottom: 2rem;
            line-height: 1.7;
            color: #555;
        }

        .product-detail-specs {
            margin-bottom: 2rem;
        }

        .spec-item {
            display: flex;
            margin-bottom: 0.5rem;
        }

        .spec-label {
            font-weight: bold;
            min-width: 120px;
            color: #666;
        }

        .product-detail-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn-detail {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            border-radius: 10px;
        }

        .btn-back {
            background: #f8f9fa;
            color: #333;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .btn-back:hover {
            color: #1e3c72;
        }

        /* Search Results */
        .search-results-title {
            margin-bottom: 1.5rem;
            color: #1e3c72;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .search-bar {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .content-tabs {
                flex-direction: column;
            }

            .category-filter {
                justify-content: center;
            }

            .product-detail-container {
                flex-direction: column;
            }

            .product-main-image {
                height: 300px;
            }

            .order-detail-header {
                flex-direction: column;
                gap: 1rem;
            }

            .timeline-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .timeline-icon {
                margin-bottom: 0.5rem;
            }
        }
    </style>
</head>
<body>

<!-- Auth Modal -->
<div id="authModal" class="modal">
    <div class="modal-content">
        <button class="close-btn" onclick="closeModal('authModal')">&times;</button>
        <div class="modal-header">
            <h3 class="modal-title" id="authTitle">Masuk ke Akun Anda</h3>
            <p class="modal-subtitle" id="authSubtitle">Silakan masuk untuk melanjutkan belanja</p>
        </div>
        
        <form id="authForm">
            <div id="signupFields" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Nama Lengkap</label>
                    <input type="text" class="form-input" id="fullName" placeholder="Masukkan nama lengkap">
                    <div class="error-message" id="fullNameError">Nama lengkap harus diisi</div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" class="form-input" id="email" placeholder="contoh@email.com">
                <div class="error-message" id="emailError">Email tidak valid</div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Password</label>
                <input type="password" class="form-input" id="password" placeholder="Masukkan password">
                <div class="error-message" id="passwordError">Password minimal 6 karakter</div>
            </div>
            
            <div id="confirmPasswordGroup" class="form-group" style="display: none;">
                <label class="form-label">Konfirmasi Password</label>
                <input type="password" class="form-input" id="confirmPassword" placeholder="Ulangi password">
                <div class="error-message" id="confirmPasswordError">Password tidak cocok</div>
            </div>
            
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" style="width: 100%;" id="authButton">Masuk</button>
                <div class="modal-switch">
                    <span id="switchText">Belum punya akun?</span>
                    <a href="#" id="switchLink" onclick="switchAuthMode()">Daftar sekarang</a>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Payment Modal -->
<div id="paymentModal" class="modal payment-modal">
    <div class="modal-content">
        <button class="close-btn" onclick="closeModal('paymentModal')">&times;</button>
        <div class="modal-header">
            <h3 class="modal-title">üí≥ Checkout Pesanan</h3>
            <p class="modal-subtitle">Lengkapi data dan pilih metode pembayaran</p>
        </div>

        <div class="success-message" id="successMessage">
            ‚úÖ Pesanan berhasil dibuat! Silakan lanjutkan pembayaran.
        </div>

        <form id="paymentForm">
            <!-- Order Summary -->
            <div class="order-summary">
                <h4 style="margin-bottom: 1rem; color: #1e3c72;">üìã Ringkasan Pesanan</h4>
                <div id="orderItems">
                    <!-- Items will be dynamically inserted here -->
                </div>
                <div class="summary-item">
                    <span>Ongkos Kirim:</span>
                    <span id="shippingCost">Rp 25.000</span>
                </div>
                <div class="summary-item" id="discountContainer" style="display: none;">
                    <span>Diskon:</span>
                    <span id="discountAmount" style="color: #27ae60;">-Rp 0</span>
                </div>
                <div class="summary-item summary-total">
                    <span>Total Pembayaran:</span>
                    <span id="totalPayment">Rp 0</span>
                </div>
            </div>

            <!-- Shipping Information -->
            <div class="payment-section">
                <h4 class="payment-title">üöö Informasi Pengiriman</h4>
                <div class="form-group">
                    <label class="form-label">Nama Penerima</label>
                    <input type="text" class="form-input" id="receiverName" placeholder="Nama lengkap penerima" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Alamat Lengkap</label>
                    <textarea class="form-input" id="address" rows="3" placeholder="Jalan, RT/RW, Kelurahan, Kecamatan, Kota, Kode Pos" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Nomor Telepon</label>
                    <input type="tel" class="form-input" id="phone" placeholder="08xxxxxxxxxx" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Pilih Kurir</label>
                    <select class="form-input" id="shippingMethod" required>
                        <option value="" disabled selected>Pilih metode pengiriman</option>
                        <option value="jne">JNE - Reguler (Rp 25.000) - 2-3 hari</option>
                        <option value="jnt">J&T - Express (Rp 30.000) - 1-2 hari</option>
                        <option value="sicepat">SiCepat - Same Day (Rp 50.000) - 1 hari</option>
                        <option value="pos">POS Indonesia - Kilat (Rp 20.000) - 3-5 hari</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Catatan Pengiriman (Opsional)</label>
                    <textarea class="form-input" id="shippingNotes" rows="2" placeholder="Contoh: Tinggal di depan warung biru"></textarea>
                </div>
            </div>

            <!-- Payment Method -->
            <div class="payment-section">
                <h4 class="payment-title">üí∞ Metode Pembayaran</h4>
                
                <div class="payment-method" onclick="selectPayment('bank')">
                    <input type="radio" name="payment" value="bank" id="paymentBank">
                    <div class="payment-icon">üè¶</div>
                    <div>
                        <strong>Transfer Bank</strong>
                        <p style="margin: 0; color: #666; font-size: 0.9rem;">BCA, Mandiri, BNI, BRI</p>
                    </div>
                </div>

                <div class="payment-method" onclick="selectPayment('ewallet')">
                    <input type="radio" name="payment" value="ewallet" id="paymentEwallet">
                    <div class="payment-icon">üì±</div>
                    <div>
                        <strong>E-Wallet</strong>
                        <p style="margin: 0; color: #666; font-size: 0.9rem;">OVO, GoPay, Dana, ShopeePay</p>
                    </div>
                </div>

                <div class="payment-method" onclick="selectPayment('cod')">
                    <input type="radio" name="payment" value="cod" id="paymentCod">
                    <div class="payment-icon">üíµ</div>
                    <div>
                        <strong>COD (Bayar di Tempat)</strong>
                        <p style="margin: 0; color: #666; font-size: 0.9rem;">Bayar saat barang diterima</p>
                    </div>
                </div>

                <div class="payment-method" onclick="selectPayment('credit')">
                    <input type="radio" name="payment" value="credit" id="paymentCredit">
                    <div class="payment-icon">üí≥</div>
                    <div>
                        <strong>Kartu Kredit/Debit</strong>
                        <p style="margin: 0; color: #666; font-size: 0.9rem;">Visa, Mastercard, JCB</p>
                    </div>
                </div>
            </div>

            <!-- Credit Card Details -->
            <div id="creditCardDetails" class="payment-section" style="display: none;">
                <h4 class="payment-title">üí≥ Detail Kartu Kredit</h4>
                <div class="form-group">
                    <label class="form-label">Nomor Kartu</label>
                    <input type="text" class="form-input" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19">
                </div>
                <div style="display: flex; gap: 1rem;">
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label">Bulan/Tahun</label>
                        <input type="text" class="form-input" id="cardExpiry" placeholder="MM/YY" maxlength="5">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label">CVV</label>
                        <input type="text" class="form-input" id="cardCvv" placeholder="123" maxlength="3">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Nama di Kartu</label>
                    <input type="text" class="form-input" id="cardName" placeholder="Nama sesuai kartu">
                </div>
            </div>

            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" style="width: 100%; padding: 1rem; font-size: 1.1rem;" id="checkoutButton">
                    üõí Buat Pesanan - Rp 0
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Profile Modal -->
<div id="profileModal" class="modal">
    <div class="modal-content">
        <button class="close-btn" onclick="closeModal('profileModal')">&times;</button>
        <div class="modal-header">
            <h3 class="modal-title">üë§ Profil Saya</h3>
            <p class="modal-subtitle">Kelola informasi profil dan riwayat pesanan</p>
        </div>
        
        <div class="profile-stats">
            <div class="profile-stat">
                <div class="profile-stat-value" id="totalOrders">0</div>
                <div class="profile-stat-label">Total Pesanan</div>
            </div>
            <div class="profile-stat">
                <div class="profile-stat-value" id="totalSpent">Rp 0</div>
                <div class="profile-stat-label">Total Belanja</div>
            </div>
        </div>
        
        <form id="profileForm">
            <div class="form-group">
                <label class="form-label">Foto Profil</label>
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div class="user-avatar" id="profileAvatar" style="width: 60px; height: 60px; font-size: 1.5rem;">JD</div>
                    <button type="button" class="btn btn-secondary" onclick="document.getElementById('avatarUpload').click()" style="padding: 0.5rem 1rem;">
                        Ubah Foto
                    </button>
                    <input type="file" id="avatarUpload" accept="image/*" style="display: none;" onchange="handleAvatarUpload(event)">
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Nama Lengkap</label>
                <input type="text" class="form-input" id="profileName" placeholder="Masukkan nama lengkap" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" class="form-input" id="profileEmail" placeholder="contoh@email.com" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Nomor Telepon</label>
                <input type="tel" class="form-input" id="profilePhone" placeholder="08xxxxxxxxxx">
            </div>
            
            <div class="form-group">
                <label class="form-label">Alamat</label>
                <textarea class="form-input" id="profileAddress" rows="3" placeholder="Alamat lengkap pengiriman"></textarea>
            </div>
            
            <div class="form-group">
                <label class="form-label">Jenis Kelamin</label>
                <div style="display: flex; gap: 1rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem;">
                        <input type="radio" name="gender" value="male" checked> Laki-laki
                    </label>
                    <label style="display: flex; align-items: center; gap: 0.5rem;">
                        <input type="radio" name="gender" value="female"> Perempuan
                    </label>
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" style="width: 100%;">Simpan Perubahan</button>
                <div class="modal-switch">
                    <a href="#" onclick="showChangePassword()">Ubah Password</a>
                </div>
            </div>
        </form>

        <!-- Order History Section -->
        <div class="order-history">
            <h3 style="margin-bottom: 1rem; color: #1e3c72;">üì¶ Riwayat Pesanan</h3>
            <div id="orderHistoryContainer">
                <div style="text-align: center; padding: 2rem; color: #666;">
                    Belum ada pesanan
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Order Detail Modal -->
<div id="orderDetailModal" class="modal order-detail-modal">
    <div class="modal-content">
        <button class="close-btn" onclick="closeModal('orderDetailModal')">&times;</button>
        
        <div class="order-detail-header">
            <div>
                <h3 class="modal-title">üì¶ Detail Pesanan</h3>
                <p class="modal-subtitle" id="orderDetailSubtitle">Informasi lengkap pesanan Anda</p>
            </div>
            <div class="order-status" id="orderDetailStatus">Processing</div>
        </div>

        <div class="order-detail-info">
            <div class="info-row">
                <span class="info-label">No. Pesanan:</span>
                <span id="orderDetailId">#12345</span>
            </div>
            <div class="info-row">
                <span class="info-label">Tanggal Pesanan:</span>
                <span id="orderDetailDate">22 Juni 2025</span>
            </div>
            <div class="info-row">
                <span class="info-label">No. Resi:</span>
                <span id="orderDetailResi">JNE123456789</span>
            </div>
            <div class="info-row">
                <span class="info-label">Total Pembayaran:</span>
                <span id="orderDetailTotal" style="color: #27ae60; font-weight: bold;">Rp 0</span>
            </div>
        </div>

        <!-- Shipping Info -->
        <div class="shipping-info">
            <h4 class="shipping-title">üöö Informasi Pengiriman</h4>
            <div class="estimate-delivery">
                <div class="estimate-title">Estimasi Tiba:</div>
                <div class="estimate-date" id="estimateDate">24 Juni 2025</div>
            </div>
            <div class="info-row">
                <span class="info-label">Kurir:</span>
                <span id="shippingCourier">JNE Regular</span>
            </div>
            <div class="info-row">
                <span class="info-label">Alamat:</span>
                <span id="shippingAddress">Alamat pengiriman</span>
            </div>
        </div>

        <!-- Tracking Timeline -->
        <div class="tracking-timeline">
            <h4 style="margin-bottom: 1.5rem; color: #1e3c72;">üìç Lacak Pengiriman</h4>
            <div id="trackingTimelineContainer">
                <!-- Timeline items will be inserted here -->
            </div>
        </div>

        <!-- Order Items -->
        <div class="order-summary">
            <h4 style="margin-bottom: 1rem; color: #1e3c72;">üìã Barang Pesanan</h4>
            <div id="orderDetailItems">
                <!-- Order items will be inserted here -->
            </div>
        </div>
    </div>
</div>

<!-- Change Password Modal -->
<div id="passwordModal" class="modal">
    <div class="modal-content">
        <button class="close-btn" onclick="closeModal('passwordModal')">&times;</button>
        <div class="modal-header">
            <h3 class="modal-title">üîí Ubah Password</h3>
            <p class="modal-subtitle">Masukkan password lama dan baru</p>
        </div>
        
        <form id="passwordForm">
            <div class="form-group">
                <label class="form-label">Password Lama</label>
                <input type="password" class="form-input" id="oldPassword" placeholder="Masukkan password lama" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Password Baru</label>
                <input type="password" class="form-input" id="newPassword" placeholder="Masukkan password baru" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Konfirmasi Password Baru</label>
                <input type="password" class="form-input" id="confirmNewPassword" placeholder="Ulangi password baru" required>
            </div>
            
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" style="width: 100%;">Simpan Password</button>
                <div class="modal-switch">
                    <a href="#" onclick="showProfile()">Kembali ke Profil</a>
                </div>
            </div>
        </form>
    </div>
</div>

<header>
    <nav class="container">
        <div class="logo">FishingPro Store</div>
        <ul class="nav-links">
            <li><a href="#beranda" class="nav-link">Beranda</a></li>
            <li><a href="#joran" class="nav-link">Joran</a></li>
            <li><a href="#reel" class="nav-link">Reel</a></li>
            <li><a href="#aksesoris" class="nav-link">Aksesoris</a></li>
        </ul>
        <div class="cart-section">
            <div class="cart-icon" onclick="switchTab('cart')">
                üõí
                <span class="cart-count" id="cartCount">0</span>
            </div>
            <div class="user-info" id="userInfo">
                <div class="user-avatar" id="userAvatar">JD</div>
                <span id="userName">John Doe</span>
                <button class="btn btn-secondary" onclick="logout()" style="padding: 0.5rem 1rem; font-size: 0.9rem;">Keluar</button>
            </div>
            <a href="#" class="btn btn-primary" id="loginBtn" onclick="openModal('authModal')">Masuk</a>
        </div>
    </nav>
</header>

<section class="hero">
    <div class="container">
        <h1>Perlengkapan Mancing Eksklusif</h1>
        <p>Jual beli joran, reel, dan aksesoris mancing premium dari brand terpercaya dunia</p>
        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Cari joran, reel, atau aksesoris mancing..." onkeyup="handleSearch(event)">
            <button type="button" onclick="performSearch()">üîç Cari</button>
        </div>
    </div>
</section>

<main class="container">
    <div class="main-content">
        <div class="content-tabs">
            <div class="tab active" onclick="switchTab('products')">üõçÔ∏è Produk Terbaru</div>
            <div class="tab" onclick="switchTab('cart')">üõí Keranjang (<span id="cartTabCount">0</span>)</div>
        </div>

        <div class="tab-content active" id="products">
            <div id="searchResultsTitle" class="search-results-title" style="display: none;"></div>
            <div class="products-grid" id="productsGrid">
                <!-- Products will be loaded here dynamically -->
            </div>
            
            <!-- Product Detail Section -->
            <div class="product-detail" id="productDetail">
                <button class="btn-back" onclick="showProductList()">
                    ‚Üê Kembali ke Daftar Produk
                </button>
                <div class="product-detail-container">
                    <div class="product-detail-gallery">
                        <div class="product-main-image" id="mainImage">
                            <!-- Main image will be shown here -->
                        </div>
                        <div class="product-thumbnails" id="productThumbnails">
                            <!-- Thumbnails will be added here -->
                        </div>
                    </div>
                    <div class="product-detail-info">
                        <h1 class="product-detail-title" id="detailTitle">Product Title</h1>
                        <div class="product-detail-brand" id="detailBrand">Brand</div>
                        <div class="product-detail-rating" id="detailRating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.9/5 (220 review)</div>
                        
                        <div class="product-detail-price">
                            <span class="product-detail-current" id="detailPrice">Rp 1.500.000</span>
                            <span class="product-detail-original" id="detailOriginalPrice"></span>
                            <span class="product-detail-discount" id="detailDiscount"></span>
                        </div>
                        
                        <div class="product-detail-description" id="detailDescription">
                            Deskripsi produk akan ditampilkan di sini dengan detail lengkap tentang spesifikasi dan fitur produk.
                        </div>
                        
                        <div class="product-detail-specs">
                            <h3>üìã Spesifikasi Produk</h3>
                            <div class="spec-item">
                                <span class="spec-label">Kategori:</span>
                                <span id="specCategory">Joran</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Material:</span>
                                <span id="specMaterial">Carbon Fiber</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Panjang:</span>
                                <span id="specLength">2.1 meter</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Berat:</span>
                                <span id="specWeight">250 gram</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Garansi:</span>
                                <span id="specWarranty">1 tahun</span>
                            </div>
                        </div>
                        
                        <div class="product-detail-actions">
                            <button class="btn btn-primary btn-detail" onclick="addToCartFromDetail()">
                                + Tambah ke Keranjang
                            </button>
                            <button class="btn btn-secondary btn-detail" onclick="buyNow()">
                                Beli Sekarang
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="cart">
            <h2>üõí Keranjang Belanja</h2>
            <div id="cartItemsContainer">
                <!-- Cart items will be loaded here dynamically -->
                <div class="empty-cart" style="text-align: center; padding: 2rem; color: #666;">
                    Keranjang belanja Anda masih kosong
                </div>
            </div>
            <div class="cart-total" id="cartTotalContainer" style="display: none;">
                <div class="total-row">
                    <span>Subtotal:</span>
                    <span id="cartSubtotal">Rp 0</span>
                </div>
                <div class="total-row">
                    <span>Ongkir:</span>
                    <span id="cartShipping">Rp 25.000</span>
                </div>
                <div class="total-row" id="shippingMethodContainer" style="display: none;">
                    <span>Metode:</span>
                    <span id="cartShippingMethod">JNE Reguler (2-3 hari)</span>
                </div>
                <div class="total-row" id="cartDiscountRow" style="display: none;">
                    <span>Diskon:</span>
                    <span id="cartDiscount">-Rp 0</span>
                </div>
                <div class="total-row total-final">
                    <span>Total:</span>
                    <span id="cartTotal">Rp 0</span>
                </div>
                <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;" onclick="openCheckoutModal()">
                    üí≥ Checkout Sekarang
                </button>
            </div>
        </div>
    </div>
</main>

<footer>
    <div class="container">
        <p>&copy; 2025 FishingPro Store - Toko Perlengkapan Mancing Eksklusif Terpercaya</p>
        <p>Prototype untuk mata kuliah Interaksi Manusia dan Komputer</p>
    </div>
</footer>

<script>
// Product data with multiple items per category
const products = {
    beranda: [
        {
            id: 'p1',
            brand: 'Shimano',
            title: 'Shimano BeastMaster',
            description: 'Reel elektrik terbaik untuk laut dalam dengan teknologi terkini',
            fullDescription: 'Shimano BeastMaster adalah reel elektrik terbaik di kelasnya dengan teknologi canggih untuk mancing laut dalam. Dilengkapi dengan sistem drag yang halus dan kuat, serta baterai tahan lama untuk sesi mancing yang panjang.',
            price: 15000000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.9/5 (220 review)',
            images: ['https://www.tsourosmarine.gr/56450-thickbox_default/shimano-beastmaster-9000-electric-reel.jpg', 'https://th.bing.com/th/id/OIP.Dpz3sZiejx3iagYjMWtzHAHaHa?w=962&h=962&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://m.media-amazon.com/images/I/618audQ+gML.jpg', 'https://cdn11.bigcommerce.com/s-55834/images/stencil/1280x1280/products/1431/21085/shimano-beastmaster-electric-reel-handle-view__87650.1706140852.jpg?c=2'],
            specs: {
                category: 'Reel Elektrik',
                material: 'Aluminium Grade',
                length: 'N/A',
                weight: '850g',
                warranty: '2 tahun'
            }
        },
        {
            id: 'p2',
            brand: 'Shimano',
            title: 'Shimano Taigra',
            description: 'Joran Trolling super kuat untuk laut dalam',
            fullDescription: 'Joran Shimano Taigra dirancang khusus untuk menghadapi ikan-ikan besar di laut dalam. Terbuat dari bahan carbon fiber berkualitas tinggi dengan kekuatan maksimal.',
            price: 18500000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.7/5 (180 review)',
            images: ['https://th.bing.com/th/id/OIP.84iUXnfVNaI1W0JwL1kJCAHaHa?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://www.gerrysfishing.com/wp-content/uploads/2023/01/image383134700.jpg', 'https://th.bing.com/th/id/OIP.TKl4C-jOutS6-AFUqgh4rwHaHa?w=2560&h=2560&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://th.bing.com/th/id/OIP.zgRZadziKgiPlTe_ryt6rwHaHa?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Joran',
                material: 'Carbon Fiber',
                length: '2.1 meter',
                weight: '250g',
                warranty: '1 tahun'
            }
        },
        {
            id: 'p3',
            brand: 'Rapala',
            title: 'Tas Pancing Waterproof',
            description: 'Kapasitas besar, bahan anti air dan ringan',
            fullDescription: 'Tas pancing Rapala ini didesain khusus untuk para angler profesional. Dengan bahan waterproof dan kompartemen yang banyak, semua peralatan mancing Anda akan terlindungi dengan baik.',
            price: 480000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.6/5 (97 review)',
            images: ['https://www.hookedonline.com.au/assets/full/46002-1.jpg?20211110164410', 'https://th.bing.com/th/id/OIP.ULWasyKvtLe6_LrpIFSdtwHaHa?w=1000&h=1000&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://www.rapala.eu/img/940/940/resize/catalog/product/5/d/5dba8jskg54ep478u2fiqtin50_b64fb6bf.png', 'https://th.bing.com/th/id/OIP.ItPtyPKrqCN5T8jK0qHg-wHaHa?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Aksesoris',
                material: 'Nylon Waterproof',
                length: '50cm x 30cm x 20cm',
                weight: '800g',
                warranty: '6 bulan'
            }
        },
        {
            id: 'p4',
            
            brand: 'Daiwa',
            title: 'Daiwa Saltiga',
            description: 'Joran kelas premium untuk mancing laut',
            fullDescription: 'Daiwa Saltiga adalah joran premium dengan sensitivitas tinggi dan kekuatan maksimal. Cocok untuk teknik casting maupun jigging di laut dengan ikan-ikan besar.',
            price: 1250000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.9/5 (150 review)',
            images: ['https://cdn.shopify.com/s/files/1/0711/3103/7995/products/saltiga-spin.jpg?v=1680631491&width=1445', 'https://discounttackle.com/cdn/shop/products/saltiga-spin-main_2260x1400.png?v=1631306299'],
            specs: {
                category: 'Joran',
                material: 'High Modulus Carbon',
                length: '2.4 meter',
                weight: '280g',
                warranty: '1.5 tahun'
            }
        },
        {
            id: 'p5',
            brand: 'Shimano',
            title: 'Shimano Talavera',
            description: 'Joran spinning ringan untuk pemula',
            fullDescription: 'Shimano Talavera adalah pilihan tepat untuk pemula yang ingin belajar teknik spinning. Ringan dan seimbang dengan harga terjangkau namun kualitas Shimano.',
            price: 1650000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.5/5 (210 review)',
            images: ['https://th.bing.com/th/id/OIP.GLI8S-uq-AegzJ2q-_2QqwHaFK?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://cdn.shoplightspeed.com/shops/665849/files/52884973/1652x1652x2/shimano-shimano-talavera-boat-spin-rod.jpg'],
            specs: {
                category: 'Joran',
                material: 'Fiberglass Composite',
                length: '1.8 meter',
                weight: '200g',
                warranty: '1 tahun'
            }
        },
        {
            id: 'p6',
            brand: 'Daiwa',
            title: 'Daiwa BG 5000',
            description: 'Reel tangguh anti karat cocok untuk laut',
            fullDescription: 'Daiwa BG 5000 adalah reel yang sangat tangguh dengan konstruksi anti karat. Dilengkapi dengan sistem drag yang halus dan kapasitas line yang besar untuk mancing di laut.',
            price: 2200000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.8/5 (300 review)',
            images: ['https://www.game-fisher.com/25306-large_default/daiwa-bg-5000-h.jpg', 'https://th.bing.com/th/id/OIP.9rseGf-GZdcCYR6-s0JRZwHaIV?w=1494&h=1680&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Reel',
                material: 'Aluminium Anti Karat',
                length: 'N/A',
                weight: '600g',
                warranty: '2 tahun'
            }
        }
    ],
    joran: [
        {
            id: 'p2',
            brand: 'Shimano',
            title: 'Shimano Taigra',
            description: 'Joran Trolling super kuat untuk laut dalam',
            fullDescription: 'Joran Shimano Taigra dirancang khusus untuk menghadapi ikan-ikan besar di laut dalam. Terbuat dari bahan carbon fiber berkualitas tinggi dengan kekuatan maksimal.',
            price: 18500000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.7/5 (180 review)',
            images: ['https://th.bing.com/th/id/OIP.84iUXnfVNaI1W0JwL1kJCAHaHa?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://www.gerrysfishing.com/wp-content/uploads/2023/01/image383134700.jpg', 'https://th.bing.com/th/id/OIP.TKl4C-jOutS6-AFUqgh4rwHaHa?w=2560&h=2560&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://th.bing.com/th/id/OIP.zgRZadziKgiPlTe_ryt6rwHaHa?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Joran',
                material: 'Carbon Fiber',
                length: '2.1 meter',
                weight: '250g',
                warranty: '1 tahun'
            }
        },
        {
            id: 'p4',
            
            brand: 'Daiwa',
            title: 'Daiwa Saltiga',
            description: 'Joran kelas premium untuk mancing laut',
            fullDescription: 'Daiwa Saltiga adalah joran premium dengan sensitivitas tinggi dan kekuatan maksimal. Cocok untuk teknik casting maupun jigging di laut dengan ikan-ikan besar.',
            price: 1250000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.9/5 (150 review)',
            images: ['https://cdn.shopify.com/s/files/1/0711/3103/7995/products/saltiga-spin.jpg?v=1680631491&width=1445', 'https://discounttackle.com/cdn/shop/products/saltiga-spin-main_2260x1400.png?v=1631306299'],
            specs: {
                category: 'Joran',
                material: 'High Modulus Carbon',
                length: '2.4 meter',
                weight: '280g',
                warranty: '1.5 tahun'
            }
        },
        {
            id: 'p5',
            brand: 'Shimano',
            title: 'Shimano Talavera',
            description: 'Joran spinning ringan untuk pemula',
            fullDescription: 'Shimano Talavera adalah pilihan tepat untuk pemula yang ingin belajar teknik spinning. Ringan dan seimbang dengan harga terjangkau namun kualitas Shimano.',
            price: 1650000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.5/5 (210 review)',
            images: ['https://th.bing.com/th/id/OIP.GLI8S-uq-AegzJ2q-_2QqwHaFK?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://cdn.shoplightspeed.com/shops/665849/files/52884973/1652x1652x2/shimano-shimano-talavera-boat-spin-rod.jpg'],
            specs: {
                category: 'Joran',
                material: 'Fiberglass Composite',
                length: '1.8 meter',
                weight: '200g',
                warranty: '1 tahun'
            }
        },
        {
            id: 'p13',
            brand: 'Penn',
            title: 'Penn Battalion',
            description: 'Joran heavy duty untuk ikan besar',
            fullDescription: 'Penn Battalion adalah joran heavy duty yang dirancang untuk menghadapi ikan-ikan besar seperti GT, Tuna, atau Marlin. Konstruksi kuat dengan action yang cepat.',
            price: 4950000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.6/5 (120 review)',
            images: ['https://th.bing.com/th/id/OIP.4_eFGH4zxD827p6fhLgakgHaEr?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://i5.walmartimages.com/asr/d74c011f-5e71-4c47-93d2-cf5a40684aec_1.1150eaef488f790a04cfb6b317e3a7d1.jpeg'],
            specs: {
                category: 'Joran',
                material: 'Carbon Composite',
                length: '2.7 meter',
                weight: '350g',
                warranty: '1 tahun'
            }
        },
        {
            id: 'p14',
            brand: 'Tica',
            title: 'Tica Dolphin',
            description: 'Joran telescopic praktis untuk dibawa',
            fullDescription: 'Tica Dolphin adalah joran telescopic yang praktis untuk dibawa traveling. Meski bisa dilipat hingga 50cm, kekuatannya tetap optimal untuk mancing di berbagai kondisi.',
            price: 6450000,
            rating: '‚≠ê‚≠ê‚≠ê 3.9/5 (85 review)',
            images: ['https://wasatchflyfishing.com/wp-content/uploads/2023/04/cts_cp7-768x1024.jpg', 'https://media.karousell.com/media/photos/products/2023/2/28/daiwa_phantom_surf_ex_450_fish_1677572280_34ec7c1c_progressive.jpg'],
            specs: {
                category: 'Joran',
                material: 'Fiberglass',
                length: '2.1 meter (bisa dilipat)',
                weight: '300g',
                warranty: '6 bulan'
            }
        },
        {
            id: 'p15',
            brand: 'Shimano',
            title: 'Shimano Catana',
            description: 'Joran all-round untuk berbagai teknik',
            fullDescription: 'Shimano Catana adalah joran serbaguna yang cocok untuk berbagai teknik mancing. Kualitas Shimano dengan harga yang lebih terjangkau untuk pemula hingga menengah.',
            price: 9550000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.3/5 (150 review)',
            images: ['https://th.bing.com/th/id/OIP.tSAJRlbmVU8JdAzkNUdmPwHaHa?pid=ImgDet&w=474&h=474&rs=1&cb=idpwebp2&o=7&rm=3', 'https://th.bing.com/th/id/OIP.Ou3xdRoKtBtb7B1eyVB4CgHaEK?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Joran',
                material: 'Carbon Fiber',
                length: '2.1 meter',
                weight: '230g',
                warranty: '1 tahun'
            }
        }
    ],
    reel: [
        {
            id: 'p1',
            brand: 'Shimano',
            title: 'Shimano BeastMaster',
            description: 'Reel elektrik terbaik untuk laut dalam dengan teknologi terkini',
            fullDescription: 'Shimano BeastMaster adalah reel elektrik terbaik di kelasnya dengan teknologi canggih untuk mancing laut dalam. Dilengkapi dengan sistem drag yang halus dan kuat, serta baterai tahan lama untuk sesi mancing yang panjang.',
            price: 15000000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.9/5 (220 review)',
            images: ['https://www.tsourosmarine.gr/56450-thickbox_default/shimano-beastmaster-9000-electric-reel.jpg', 'https://th.bing.com/th/id/OIP.Dpz3sZiejx3iagYjMWtzHAHaHa?w=962&h=962&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://m.media-amazon.com/images/I/618audQ+gML.jpg', 'https://cdn11.bigcommerce.com/s-55834/images/stencil/1280x1280/products/1431/21085/shimano-beastmaster-electric-reel-handle-view__87650.1706140852.jpg?c=2'],
            specs: {
                category: 'Reel Elektrik',
                material: 'Aluminium Grade',
                length: 'N/A',
                weight: '850g',
                warranty: '2 tahun'
            }
        },
        {
            id: 'p6',
            brand: 'Daiwa',
            title: 'Daiwa BG 5000',
            description: 'Reel tangguh anti karat cocok untuk laut',
            fullDescription: 'Daiwa BG 5000 adalah reel yang sangat tangguh dengan konstruksi anti karat. Dilengkapi dengan sistem drag yang halus dan kapasitas line yang besar untuk mancing di laut.',
            price: 2200000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.8/5 (300 review)',
            images: ['https://www.game-fisher.com/25306-large_default/daiwa-bg-5000-h.jpg', 'https://th.bing.com/th/id/OIP.9rseGf-GZdcCYR6-s0JRZwHaIV?w=1494&h=1680&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Reel',
                material: 'Aluminium Anti Karat',
                length: 'N/A',
                weight: '600g',
                warranty: '2 tahun'
            }
        },
        {
            id: 'p7',
            brand: 'Penn',
            title: 'Penn International',
            description: 'Reel profesional untuk mancing besar',
            fullDescription: 'Penn International adalah reel profesional yang digunakan oleh para pemancing kelas dunia. Dengan konstruksi metal penuh dan sistem drag yang presisi, reel ini bisa menghadapi ikan-ikan terbesar.',
            price: 3500000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5.0/5 (180 review)',
            images: ['https://th.bing.com/th/id/OIP.epWGWe3vLZHFUM4jLXKf8wAAAA?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://th.bing.com/th/id/OIP.IiLhj-dO7oLHzJNKO2H45wAAAA?w=300&h=300&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Reel',
                material: 'Aluminium & Stainless Steel',
                length: 'N/A',
                weight: '750g',
                warranty: '3 tahun'
            }
        },
        {
            id: 'p16',
            brand: 'Shimano',
            title: 'Shimano Stella',
            description: 'Reel spinning presisi untuk berbagai kondisi',
            fullDescription: 'Shimano Stella adalah reel spinning dengan presisi tinggi yang cocok untuk berbagai kondisi mancing. Dilengkapi dengan teknologi Hagane Body untuk kekuatan maksimal.',
            price: 19800000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.9/5 (200 review)',
            images: ['https://th.bing.com/th/id/OIP.UK6L343LKgumUyXggBc8VgHaHa?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://image.ec21.com/image/davidfishingreel/oimg_GC09713046_CA09713111/Shimano-Stella-SWB-STL10000SWBPG-Saltwater-Spinning-Reel.jpg'],
            specs: {
                category: 'Reel Spinning',
                material: 'Hagane Body',
                length: 'N/A',
                weight: '300g',
                warranty: '2 tahun'
            }
        },
        {
            id: 'p17',
            brand: 'Okuma',
            title: 'Okuma Ceymar',
            description: 'Reel spinning ekonomis dengan performa baik',
            fullDescription: 'Okuma Ceymar adalah reel spinning dengan harga ekonomis namun tetap memiliki performa yang baik. Cocok untuk pemula atau sebagai reel cadangan.',
            price: 850000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.2/5 (95 review)',
            images: ['https://th.bing.com/th/id/OIP.YOVS9Ww-eAggbGeXHjAnrgHaE8?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://th.bing.com/th/id/OIP.tfwwp5lQbsJkEmLHsFtOHgHaHa?w=600&h=600&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Reel Spinning',
                material: 'Grafite Composite',
                length: 'N/A',
                weight: '280g',
                warranty: '1 tahun'
            }
        },
        {
            id: 'p18',
            
            brand: 'Abu Garcia',
            title: 'Abu Garcia Revo',
            description: 'Reel baitcasting presisi untuk teknik casting',
            fullDescription: 'Abu Garcia Revo adalah reel baitcasting dengan presisi tinggi untuk teknik casting. Dilengkapi dengan sistem braking yang bisa diatur sesuai kebutuhan.',
            price: 3200000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.8/5 (150 review)',
            images: ['https://th.bing.com/th/id/OIP.Uq42QoKwTUSYHBVodiJCowHaHa?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://i.tackledirect.com/images/img600/abu-garcia-revo-premier-spinning-reels.jpg'],
            specs: {
                category: 'Reel Baitcasting',
                material: 'Aluminium & Carbon',
                length: 'N/A',
                weight: '220g',
                warranty: '2 tahun'
            }
        }
    ],
    aksesoris: [
        {
            id: 'p3',
            brand: 'Rapala',
            title: 'Tas Pancing Waterproof',
            description: 'Kapasitas besar, bahan anti air dan ringan',
            fullDescription: 'Tas pancing Rapala ini didesain khusus untuk para angler profesional. Dengan bahan waterproof dan kompartemen yang banyak, semua peralatan mancing Anda akan terlindungi dengan baik.',
            price: 480000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.6/5 (97 review)',
            images: ['https://www.hookedonline.com.au/assets/full/46002-1.jpg?20211110164410', 'https://th.bing.com/th/id/OIP.ULWasyKvtLe6_LrpIFSdtwHaHa?w=1000&h=1000&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://www.rapala.eu/img/940/940/resize/catalog/product/5/d/5dba8jskg54ep478u2fiqtin50_b64fb6bf.png', 'https://th.bing.com/th/id/OIP.ItPtyPKrqCN5T8jK0qHg-wHaHa?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Aksesoris',
                material: 'Nylon Waterproof',
                length: '50cm x 30cm x 20cm',
                weight: '800g',
                warranty: '6 bulan'
            }
        },
        {
            id: 'p8',
            brand: 'PowerPro',
            title: 'Tali Pancing Braided',
            description: 'Tali super kuat diameter 0.30mm 150m',
            fullDescription: 'Tali braided PowerPro terkenal dengan kekuatannya yang tinggi dibanding diameternya yang kecil. Dengan warna yang tidak mudah pudar dan struktur yang halus untuk casting yang lebih jauh.',
            price: 350000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.4/5 (120 review)',
            images: ['https://th.bing.com/th/id/OIP.OREJwQU-GKmo2JeFqv365gHaIO?rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3', 'https://th.bing.com/th/id/OIP.pa6ySUwPUtOImhkiAo3XMgHaHa?w=1000&h=1000&rs=1&pid=ImgDetMain&cb=idpwebp2&o=7&rm=3'],
            specs: {
                category: 'Tali',
                material: 'Spectra Fiber',
                length: '150 meter',
                weight: '50g',
                warranty: 'N/A'
            }
        },
        {
            id: 'p9',
            brand: 'Mustad',
            title: 'Set Kail Premium',
            description: '10 kail berbagai ukuran untuk berbagai ikan',
            fullDescription: 'Set kail premium dari Mustad ini berisi 10 kail dengan berbagai ukuran dan tipe untuk menangkap berbagai jenis ikan. Terbuat dari baja berkualitas tinggi dengan lapisan anti karat.',
            price: 250000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.3/5 (95 review)',
            images: ['https://cdn.sanity.io/images/54z632nj/mustad-fishing/2797e1c71ccdafa1b7aa0a9291a2fff6e8225a8f-5070x3380.jpg?w=3840&h=2560&auto=format'],
            specs: {
                category: 'Kail',
                material: 'Baja Anti Karat',
                length: 'Berbagai ukuran',
                weight: '30g',
                warranty: 'N/A'
            }
        },
        {
            id: 'p19',
            brand: 'Shimano',
            title: 'Sarung Tangan Pancing',
            description: 'Sarung tangan untuk proteksi saat mancing',
            fullDescription: 'Sarung tangan pancing Shimano dirancang untuk melindungi tangan dari gesekan tali atau ikan yang bergerak. Nyaman dipakai dengan grip yang baik saat memegang ikan.',
            price: 180000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.2/5 (60 review)',
            images: ['https://down-id.img.susercontent.com/file/sg-11134201-22110-mww9hchjpckv17'],
            specs: {
                category: 'Aksesoris',
                material: 'Neoprene',
                length: 'One Size',
                weight: '50g',
                warranty: '3 bulan'
            }
        },
        {
            id: 'p20',
            emoji: 'üß¢',
            brand: 'Columbia',
            title: 'Topi Pancing UV Protection',
            description: 'Topi dengan proteksi UV 50+',
            fullDescription: 'Topi pancing Columbia ini dilengkapi dengan proteksi UV 50+ untuk melindungi dari terik matahari saat mancing seharian. Desainnya ringan dan memiliki ventilasi yang baik.',
            price: 220000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.5/5 (80 review)',
            images: ['https://media.karousell.com/media/photos/products/2023/11/26/columbia_hats_1700991911_94582c62_progressive'],
            specs: {
                category: 'Aksesoris',
                material: 'Polyester Quick Dry',
                length: 'Adjustable',
                weight: '100g',
                warranty: '3 bulan'
            }
        },
        {
            id: 'p21',
            brand: 'Plano',
            title: 'Kotak Peralatan Pancing',
            description: 'Kotak organizer untuk menyimpan peralatan',
            fullDescription: 'Kotak peralatan pancing Plano memiliki banyak kompartemen untuk menyimpan berbagai aksesoris pancing secara rapi. Bahan plastik tahan air dengan kunci yang aman.',
            price: 320000,
            rating: '‚≠ê‚≠ê‚≠ê‚≠ê 4.3/5 (70 review)',
            images: ['https://th.bing.com/th/id/R.f5897a97a095f76c3ee3b6baabc2f80f?rik=ejbFsVp3WlebjQ&riu=http%3a%2f%2fimage.sportsmansguide.com%2fadimgs%2fl%2f2%2f225378_ts.jpg&ehk=ztRJI2YSGmfK79oMGufIsZGYTjYiJUDDxOeXNsC2QlI%3d&risl=&pid=ImgRaw&r=0'],
            specs: {
                category: 'Aksesoris',
                material: 'Plastik ABS',
                length: '30cm x 20cm x 10cm',
                weight: '500g',
                warranty: '6 bulan'
            }
        }
    ]
    
};

// Shipping tracking statuses
const trackingStatuses = [
    {
        id: 'ordered',
        title: 'Pesanan Dikonfirmasi',
        description: 'Pesanan Anda telah dikonfirmasi dan akan segera diproses',
        icon: 'üìù'
    },
    {
        id: 'processed',
        title: 'Pesanan Diproses',
        description: 'Pesanan sedang disiapkan dan dikemas',
        icon: 'üì¶'
    },
    {
        id: 'shipped',
        title: 'Paket Dikirim',
        description: 'Paket telah diserahkan ke kurir dan dalam perjalanan',
        icon: 'üöö'
    },
    {
        id: 'transit',
        title: 'Dalam Perjalanan',
        description: 'Paket sedang dalam perjalanan menuju kota tujuan',
        icon: 'üõ£Ô∏è'
    },
    {
        id: 'arrived',
        title: 'Tiba di Kota Tujuan',
        description: 'Paket telah tiba di kota tujuan dan siap diantar',
        icon: 'üè™'
    },
    {
        id: 'delivering',
        title: 'Sedang Diantar',
        description: 'Kurir sedang dalam perjalanan menuju alamat Anda',
        icon: 'üèÉ'
    },
    {
        id: 'delivered',
        title: 'Paket Diterima',
        description: 'Paket telah berhasil diterima oleh penerima',
        icon: '‚úÖ'
    }
];

// Current state
let currentCategory = 'beranda';
let isLoginMode = true;
let cartItems = [];
let currentProduct = null;
let isSearching = false;
let searchQuery = '';
let currentUser = null;

// Shipping methods data
const shippingMethods = {
    jne: { name: "JNE Reguler", price: 25000, estimate: "2-3 hari" },
    jnt: { name: "J&T Express", price: 30000, estimate: "1-2 hari" },
    sicepat: { name: "SiCepat Same Day", price: 50000, estimate: "1 hari" },
    pos: { name: "POS Kilat", price: 20000, estimate: "3-5 hari" }
};

// DOM elements
const productsGrid = document.getElementById('productsGrid');
const productDetail = document.getElementById('productDetail');
const navLinks = document.querySelectorAll('.nav-link');
const cartCount = document.getElementById('cartCount');
const cartTabCount = document.getElementById('cartTabCount');
const cartItemsContainer = document.getElementById('cartItemsContainer');
const cartTotalContainer = document.getElementById('cartTotalContainer');
const searchInput = document.getElementById('searchInput');
const searchResultsTitle = document.getElementById('searchResultsTitle');

// Initialize the page
function init() {
    loadProducts(currentCategory);
    updateCart();
    
    // Check for saved user
    const savedUser = localStorage.getItem('currentUser');
    if (savedUser) {
        currentUser = JSON.parse(savedUser);
        showUserLoggedIn();
    }
    
    // Check for saved cart
    const savedCart = localStorage.getItem('cartItems');
    if (savedCart) {
        cartItems = JSON.parse(savedCart);
        updateCart();
    }
    
    // Event listeners
    document.getElementById('authForm').addEventListener('submit', handleAuthSubmit);
    document.getElementById('paymentForm').addEventListener('submit', handlePaymentSubmit);
    document.getElementById('profileForm').addEventListener('submit', handleProfileSubmit);
    document.getElementById('passwordForm').addEventListener('submit', handlePasswordSubmit);
    document.getElementById('shippingMethod').addEventListener('change', updateShippingCost);
    
    // Navigation links
    navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const category = link.getAttribute('href').substring(1);
            currentCategory = category;
            isSearching = false;
            searchInput.value = '';
            loadProducts(category);
            showProductList();
        });
    });

    // Add click handler for user avatar
    document.getElementById('userAvatar').addEventListener('click', function(e) {
        e.stopPropagation();
        showProfile();
    });
}

// Show user as logged in
function showUserLoggedIn() {
    document.getElementById('loginBtn').style.display = 'none';
    document.getElementById('userInfo').style.display = 'flex';
    document.getElementById('userName').textContent = currentUser.name;
    
    const userAvatar = document.getElementById('userAvatar');
    userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
    
    if (currentUser.avatar) {
        userAvatar.style.backgroundImage = `url(${currentUser.avatar})`;
        userAvatar.style.backgroundSize = 'cover';
        userAvatar.textContent = '';
    }
}

// Generate tracking number
function generateTrackingNumber(courier) {
    const prefix = courier.toUpperCase();
    const timestamp = Date.now().toString().slice(-6);
    const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
    return `${prefix}${timestamp}${random}`;
}

// Generate order timeline
function generateOrderTimeline(order) {
    const timeline = [];
    const baseDate = new Date(order.date);
    
    // Always add the first status (ordered)
    timeline.push({
        ...trackingStatuses[0],
        date: baseDate,
        completed: true
    });

    // Add subsequent statuses based on order age
    const hoursSinceOrder = (Date.now() - baseDate.getTime()) / (1000 * 60 * 60);
    
    for (let i = 1; i < trackingStatuses.length; i++) {
        const status = trackingStatuses[i];
        const statusDate = new Date(baseDate.getTime() + (i * 6 * 60 * 60 * 1000)); // 6 hours apart
        
        let completed = false;
        let current = false;
        
        if (order.status === 'delivered') {
            completed = true;
        } else if (hoursSinceOrder > (i * 6)) {
            completed = true;
        } else if (hoursSinceOrder > ((i - 1) * 6) && hoursSinceOrder <= (i * 6)) {
            current = true;
        }
        
        timeline.push({
            ...status,
            date: statusDate,
            completed: completed,
            current: current
        });
    }
    
    return timeline;
}

// Update shipping cost
function updateShippingCost() {
    const shippingMethod = document.getElementById('shippingMethod').value;
    const shippingCostElement = document.getElementById('shippingCost');
    const cartShippingElement = document.getElementById('cartShipping');
    
    if (shippingMethod && shippingMethods[shippingMethod]) {
        const shipping = shippingMethods[shippingMethod];
        shippingCostElement.textContent = `Rp ${formatPrice(shipping.price)} (${shipping.name} - ${shipping.estimate})`;
        cartShippingElement.textContent = `Rp ${formatPrice(shipping.price)}`;
    } else {
        shippingCostElement.textContent = "Rp 25.000";
        cartShippingElement.textContent = "Rp 25.000";
    }
    
    updateOrderSummary();
}

// Update order summary
function updateOrderSummary() {
    const subtotal = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const shippingMethod = document.getElementById('shippingMethod').value;
    const shipping = shippingMethod ? shippingMethods[shippingMethod].price : 25000;
    const discount = subtotal >= 5000000 ? subtotal * 0.1 : 0;
    const total = subtotal + shipping - discount;
    
    // Update order items
    const orderItemsContainer = document.getElementById('orderItems');
    orderItemsContainer.innerHTML = '';
    
    cartItems.forEach(item => {
        const itemElement = document.createElement('div');
        itemElement.className = 'summary-item';
        itemElement.innerHTML = `
            <span>${item.title} (${item.quantity}x):</span>
            <span>Rp ${formatPrice(item.price * item.quantity)}</span>
        `;
        orderItemsContainer.appendChild(itemElement);
    });
    
    // Update shipping cost
    const shippingCostElement = document.getElementById('shippingCost');
    if (shippingMethod && shippingMethods[shippingMethod]) {
        const shippingInfo = shippingMethods[shippingMethod];
        shippingCostElement.textContent = `Rp ${formatPrice(shippingInfo.price)} (${shippingInfo.name} - ${shippingInfo.estimate})`;
    } else {
        shippingCostElement.textContent = `Rp ${formatPrice(shipping)}`;
    }
    
    // Update discount
    if (discount > 0) {
        document.getElementById('discountContainer').style.display = 'flex';
        document.getElementById('discountAmount').textContent = `-Rp ${formatPrice(discount)}`;
    } else {
        document.getElementById('discountContainer').style.display = 'none';
    }
    
    // Update total
    document.getElementById('totalPayment').textContent = `Rp ${formatPrice(total)}`;
    document.getElementById('checkoutButton').innerHTML = `üõí Buat Pesanan - Rp ${formatPrice(total)}`;
}

// Load products for a category or search results
function loadProducts(category) {
    let categoryProducts = [];
    
    if (isSearching) {
        // Search all products
        const allProducts = [];
        for (const cat in products) {
            allProducts.push(...products[cat]);
        }
        
        categoryProducts = allProducts.filter(product => 
            product.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
            product.brand.toLowerCase().includes(searchQuery.toLowerCase()) ||
            product.description.toLowerCase().includes(searchQuery.toLowerCase())
        );
        
        searchResultsTitle.textContent = `Hasil pencarian untuk "${searchQuery}" (${categoryProducts.length} produk ditemukan)`;
        searchResultsTitle.style.display = categoryProducts.length > 0 ? 'block' : 'none';
    } else {
        // Load category products
        categoryProducts = products[category] || [];
        searchResultsTitle.style.display = 'none';
    }
    
    productsGrid.innerHTML = '';
    
    if (categoryProducts.length === 0) {
        const emptyMessage = isSearching ? 
            `Tidak ditemukan produk untuk "${searchQuery}"` : 
            'Tidak ada produk dalam kategori ini';
            
        productsGrid.innerHTML = `<div style="text-align: center; padding: 2rem; color: #666;">${emptyMessage}</div>`;
        return;
    }
    
    categoryProducts.forEach(product => {
        const productCard = document.createElement('div');
        productCard.className = 'product-card';
        productCard.innerHTML = `
            <div class="product-image" onclick="showProductDetail('${product.id}')">
                <img src="${product.images[0]}" alt="${product.title}" style="width:100%; height:100%; object-fit:cover;">
            </div>
            <div class="product-info">
                <div class="product-brand">${product.brand}</div>
                <div class="product-title" onclick="showProductDetail('${product.id}')">${product.title}</div>
                <div class="product-description">${product.description}</div>
                <div class="product-price">
                    <span class="price-current">Rp ${formatPrice(product.price)}</span>
                    ${product.originalPrice ? `<span class="price-original">Rp ${formatPrice(product.originalPrice)}</span>` : ''}
                </div>
                <div class="product-rating">${product.rating}</div>
                <button class="btn btn-add-cart" onclick="addToCart('${product.id}')">+ Tambah ke Keranjang</button>
            </div>
        `;
        productsGrid.appendChild(productCard);
    });
}

// Handle search input
function handleSearch(event) {
    if (event.key === 'Enter') {
        performSearch();
    }
}

// Perform search
function performSearch() {
    searchQuery = searchInput.value.trim();
    if (searchQuery === '') {
        isSearching = false;
        loadProducts(currentCategory);
        return;
    }
    
    isSearching = true;
    loadProducts();
}

// Show product detail
function showProductDetail(productId) {
    // Cari produk berdasarkan ID dari semua kategori
    let product = null;
    for (const category in products) {
        product = products[category].find(p => p.id === productId);
        if (product) break;
    }

    if (!product) return;

    currentProduct = product;

    // Isi informasi detail produk
    document.getElementById('detailTitle').textContent = product.title;
    document.getElementById('detailBrand').textContent = product.brand;
    document.getElementById('detailRating').textContent = product.rating;
    document.getElementById('detailPrice').textContent = `Rp ${formatPrice(product.price)}`;
    document.getElementById('detailDescription').textContent = product.fullDescription;

    // Harga asli & diskon
    const originalPriceEl = document.getElementById('detailOriginalPrice');
    const discountEl = document.getElementById('detailDiscount');

    if (product.originalPrice) {
        originalPriceEl.textContent = `Rp ${formatPrice(product.originalPrice)}`;
        const discount = Math.round((1 - product.price / product.originalPrice) * 100);
        discountEl.textContent = `${discount}% OFF`;
        originalPriceEl.style.display = 'inline';
        discountEl.style.display = 'inline';
    } else {
        originalPriceEl.style.display = 'none';
        discountEl.style.display = 'none';
    }

    // Spesifikasi produk
    document.getElementById('specCategory').textContent = product.specs.category;
    document.getElementById('specMaterial').textContent = product.specs.material;
    document.getElementById('specLength').textContent = product.specs.length;
    document.getElementById('specWeight').textContent = product.specs.weight;
    document.getElementById('specWarranty').textContent = product.specs.warranty;

    // Gambar utama & thumbnail
    const mainImage = document.getElementById('mainImage');
    const thumbnailsContainer = document.getElementById('productThumbnails');

    // Set gambar utama dengan gambar pertama
    mainImage.innerHTML = `<img src="${product.images[0]}" alt="${product.title}" style="width:100%; border-radius:12px;">`;
    thumbnailsContainer.innerHTML = '';

    // Buat thumbnail untuk setiap gambar produk
    product.images.forEach((imgSrc, index) => {
        const thumbnail = document.createElement('div');
        thumbnail.className = 'product-thumbnail' + (index === 0 ? ' active' : '');
        thumbnail.innerHTML = `<img src="${imgSrc}" alt="thumbnail ${index + 1}" style="width:100%; border-radius:8px; cursor:pointer;">`;
        thumbnail.onclick = () => {
            mainImage.innerHTML = `<img src="${imgSrc}" alt="${product.title}" style="width:100%; border-radius:12px;">`;
            // Hapus kelas active dari semua thumbnail
            document.querySelectorAll('.product-thumbnail').forEach(t => t.classList.remove('active'));
            // Tambah kelas active ke thumbnail yang diklik
            thumbnail.classList.add('active');
        };
        thumbnailsContainer.appendChild(thumbnail);
    });

    // Tampilkan detail produk dan sembunyikan grid produk
    document.getElementById('productsGrid').style.display = 'none';
    productDetail.classList.add('active');
}



// Show product list
function showProductList() {
    document.getElementById('productsGrid').style.display = 'grid';
    productDetail.classList.remove('active');
}

// Add to cart from detail page
function addToCartFromDetail() {
    if (!currentProduct) return;
    addToCart(currentProduct.id);
}

// Buy now function
function buyNow() {
    if (!currentProduct) return;
    
    // Clear cart and add current product
    cartItems = [{
        id: currentProduct.id,
        title: currentProduct.title,
        emoji: currentProduct.emoji,
        price: currentProduct.price,
        quantity: 1
    }];
    
    updateCart();
    openCheckoutModal();
    showProductList();
    switchTab('cart');
}

// Format price with thousand separators
function formatPrice(price) {
    return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
}

// Cart functions
function addToCart(productId) {
    if (!currentUser) {
        openModal('authModal');
        return;
    }
    
    // Find product in all categories
    let product = null;
    for (const category in products) {
        product = products[category].find(p => p.id === productId);
        if (product) break;
    }
    
    if (!product) return;
    
    const existingItem = cartItems.find(item => item.id === productId);
    if (existingItem) {
        existingItem.quantity += 1;
    } else {
        cartItems.push({
            id: product.id,
            title: product.title,
            image: product.images[0], // Simpan gambar pertama produk
            price: product.price,
            quantity: 1
        });
    }
    
    updateCart();
    showToast(`${product.title} ditambahkan ke keranjang`);
}

function removeFromCart(productId) {
    cartItems = cartItems.filter(item => item.id !== productId);
    updateCart();
}

function updateQuantity(productId, change) {
    const item = cartItems.find(item => item.id === productId);
    if (!item) return;
    
    item.quantity += change;
    
    if (item.quantity < 1) {
        removeFromCart(productId);
    } else {
        updateCart();
    }
}

function updateCart() {
    // Save to localStorage
    localStorage.setItem('cartItems', JSON.stringify(cartItems));
    
    // Update cart count
    const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
    cartCount.textContent = totalItems;
    cartTabCount.textContent = totalItems;
    
    // Update cart items display
    if (cartItems.length === 0) {
        cartItemsContainer.innerHTML = '<div class="empty-cart" style="text-align: center; padding: 2rem; color: #666;">Keranjang belanja Anda masih kosong</div>';
        cartTotalContainer.style.display = 'none';
    } else {
        cartItemsContainer.innerHTML = '';
        cartTotalContainer.style.display = 'block';
        
        cartItems.forEach(item => {
            const cartItem = document.createElement('div');
            cartItem.className = 'cart-item';
            cartItem.innerHTML = `
                <div class="cart-item-image">
                    <img src="${item.image}" alt="${item.title}" style="width:100%; height:100%; object-fit:cover; border-radius:8px;">
                </div>
                <div class="cart-item-info">
                    <div class="cart-item-title">${item.title}</div>
                    <div class="cart-item-price">Rp ${formatPrice(item.price)}</div>
                </div>
                <div class="quantity-control">
                    <button class="quantity-btn" onclick="updateQuantity('${item.id}', -1)">-</button>
                    <span>${item.quantity}</span>
                    <button class="quantity-btn" onclick="updateQuantity('${item.id}', 1)">+</button>
                </div>
            `;
            cartItemsContainer.appendChild(cartItem);
        });
        
        // Calculate totals
        const subtotal = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const shippingMethod = document.getElementById('shippingMethod').value;
        const shipping = shippingMethod ? shippingMethods[shippingMethod].price : 25000;
        const discount = subtotal >= 5000000 ? subtotal * 0.1 : 0;
        const total = subtotal + shipping - discount;
        
        document.getElementById('cartSubtotal').textContent = `Rp ${formatPrice(subtotal)}`;
        document.getElementById('cartShipping').textContent = `Rp ${formatPrice(shipping)}`;
        
        if (shippingMethod) {
            document.getElementById('shippingMethodContainer').style.display = 'flex';
            document.getElementById('cartShippingMethod').textContent = 
                `${shippingMethods[shippingMethod].name} (${shippingMethods[shippingMethod].estimate})`;
        } else {
            document.getElementById('shippingMethodContainer').style.display = 'none';
        }
        
        if (discount > 0) {
            document.getElementById('cartDiscountRow').style.display = 'flex';
            document.getElementById('cartDiscount').textContent = `-Rp ${formatPrice(discount)}`;
        } else {
            document.getElementById('cartDiscountRow').style.display = 'none';
        }
        
        document.getElementById('cartTotal').textContent = `Rp ${formatPrice(total)}`;
    }
}

// Show profile modal
function showProfile() {
    if (!currentUser) {
        openModal('authModal');
        return;
    }
    
    // Fill profile form with current user data
    document.getElementById('profileName').value = currentUser.name || '';
    document.getElementById('profileEmail').value = currentUser.email || '';
    document.getElementById('profilePhone').value = currentUser.phone || '';
    document.getElementById('profileAddress').value = currentUser.address || '';
    document.querySelector(`input[name="gender"][value="${currentUser.gender || 'male'}"]`).checked = true;
    
    // Update profile avatar
    const profileAvatar = document.getElementById('profileAvatar');
    profileAvatar.textContent = currentUser.name ? currentUser.name.charAt(0).toUpperCase() : 'U';
    
    if (currentUser.avatar) {
        profileAvatar.style.backgroundImage = `url(${currentUser.avatar})`;
        profileAvatar.style.backgroundSize = 'cover';
        profileAvatar.textContent = '';
    }
    
    // Update profile stats
    const orders = currentUser.orders || [];
    const totalOrders = orders.length;
    const totalSpent = orders.reduce((sum, order) => {
        const orderTotal = order.items.reduce((itemSum, item) => itemSum + (item.price * item.quantity), 0);
        return sum + orderTotal + (order.shipping ? order.shipping.cost : 25000);
    }, 0);
    
    document.getElementById('totalOrders').textContent = totalOrders;
    document.getElementById('totalSpent').textContent = `Rp ${formatPrice(totalSpent)}`;
    
    // Update order history
    updateOrderHistory();
    
    openModal('profileModal');
}

// Update order history display
function updateOrderHistory() {
    const orderHistoryContainer = document.getElementById('orderHistoryContainer');
    const orders = currentUser.orders || [];
    
    if (orders.length === 0) {
        orderHistoryContainer.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">Belum ada pesanan</div>';
        return;
    }
    
    orderHistoryContainer.innerHTML = '';
    
    // Sort orders by date (newest first)
    orders.sort((a, b) => new Date(b.date) - new Date(a.date));
    
    orders.forEach(order => {
        const orderElement = document.createElement('div');
        orderElement.className = 'order-item';
        orderElement.onclick = () => showOrderDetail(order.id);
        
        const orderDate = new Date(order.date).toLocaleDateString('id-ID', {
            day: 'numeric',
            month: 'long',
            year: 'numeric'
        });
        
        const orderTotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const totalWithShipping = orderTotal + (order.shipping ? order.shipping.cost : 25000);
        
        // Determine status
        let statusClass = 'processing';
        let statusText = 'Diproses';
        
        const hoursSinceOrder = (Date.now() - new Date(order.date).getTime()) / (1000 * 60 * 60);
        
        if (hoursSinceOrder > 48) {
            statusClass = 'delivered';
            statusText = 'Selesai';
        } else if (hoursSinceOrder > 24) {
            statusClass = 'shipped';
            statusText = 'Dikirim';
        }
        
        orderElement.innerHTML = `
            <div class="order-header">
                <div>
                    <strong>Pesanan #${order.id}</strong>
                    <div class="order-date">${orderDate}</div>
                </div>
                <div class="order-status ${statusClass}">${statusText}</div>
            </div>
            <div class="order-products">
                ${order.items.map(item => `${item.title} (${item.quantity}x)`).join(', ')}
            </div>
            <div class="order-total">Total: Rp ${formatPrice(totalWithShipping)}</div>
            <div class="order-resi">Resi: ${order.trackingNumber || 'Belum tersedia'}</div>
        `;
        
        orderHistoryContainer.appendChild(orderElement);
    });
}

// Show order detail modal
function showOrderDetail(orderId) {
    const order = currentUser.orders.find(o => o.id === orderId);
    if (!order) return;
    
    // Update order detail info
    document.getElementById('orderDetailId').textContent = `#${order.id}`;
    document.getElementById('orderDetailDate').textContent = new Date(order.date).toLocaleDateString('id-ID', {
        day: 'numeric',
        month: 'long',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    });
    document.getElementById('orderDetailResi').textContent = order.trackingNumber || 'Belum tersedia';
    
    // Calculate total
    const orderTotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const totalWithShipping = orderTotal + (order.shipping ? order.shipping.cost : 25000);
    document.getElementById('orderDetailTotal').textContent = `Rp ${formatPrice(totalWithShipping)}`;
    
    // Update status
    const hoursSinceOrder = (Date.now() - new Date(order.date).getTime()) / (1000 * 60 * 60);
    let statusClass = 'processing';
    let statusText = 'Diproses';
    
    if (hoursSinceOrder > 48) {
        statusClass = 'delivered';
        statusText = 'Selesai';
    } else if (hoursSinceOrder > 24) {
        statusClass = 'shipped';
        statusText = 'Dikirim';
    }
    
    const statusElement = document.getElementById('orderDetailStatus');
    statusElement.className = `order-status ${statusClass}`;
    statusElement.textContent = statusText;
    
    // Update shipping info
    document.getElementById('shippingCourier').textContent = order.shipping ? order.shipping.method : 'JNE Regular';
    document.getElementById('shippingAddress').textContent = order.shipping ? order.shipping.address : 'Alamat tidak tersedia';
    
    // Update estimate date
    const estimateDate = new Date(order.date);
    estimateDate.setDate(estimateDate.getDate() + 3); // Add 3 days
    document.getElementById('estimateDate').textContent = estimateDate.toLocaleDateString('id-ID', {
        day: 'numeric',
        month: 'long',
        year: 'numeric'
    });
    
    // Update tracking timeline
    const timeline = generateOrderTimeline(order);
    const timelineContainer = document.getElementById('trackingTimelineContainer');
    timelineContainer.innerHTML = '';
    
    timeline.forEach(item => {
        const timelineElement = document.createElement('div');
        timelineElement.className = `timeline-item ${item.completed ? 'active' : ''} ${item.current ? 'current' : ''}`;
        
        const timelineDate = item.date.toLocaleDateString('id-ID', {
            day: 'numeric',
            month: 'short',
            hour: '2-digit',
            minute: '2-digit'
        });
        
        timelineElement.innerHTML = `
            <div class="timeline-icon ${item.completed ? 'active' : ''} ${item.current ? 'current' : ''}">${item.icon}</div>
            <div class="timeline-content">
                <div class="timeline-title">${item.title}</div>
                <div class="timeline-description">${item.description}</div>
                <div class="timeline-date">${item.completed || item.current ? timelineDate : ''}</div>
            </div>
        `;
        
        timelineContainer.appendChild(timelineElement);
    });
    
    // Update order items
    const orderItemsContainer = document.getElementById('orderDetailItems');
    orderItemsContainer.innerHTML = '';
    
    order.items.forEach(item => {
        const itemElement = document.createElement('div');
        itemElement.className = 'summary-item';
        itemElement.innerHTML = `
            <span>${item.title} (${item.quantity}x):</span>
            <span>Rp ${formatPrice(item.price * item.quantity)}</span>
        `;
        orderItemsContainer.appendChild(itemElement);
    });
    
    // Add shipping cost
    const shippingElement = document.createElement('div');
    shippingElement.className = 'summary-item';
    shippingElement.innerHTML = `
        <span>Ongkos Kirim:</span>
        <span>Rp ${formatPrice(order.shipping ? order.shipping.cost : 25000)}</span>
    `;
    orderItemsContainer.appendChild(shippingElement);
    
    // Add total
    const totalElement = document.createElement('div');
    totalElement.className = 'summary-item summary-total';
    totalElement.innerHTML = `
        <span>Total:</span>
        <span>Rp ${formatPrice(totalWithShipping)}</span>
    `;
    orderItemsContainer.appendChild(totalElement);
    
    closeModal('profileModal');
    openModal('orderDetailModal');
}

// Show change password modal
function showChangePassword() {
    closeModal('profileModal');
    openModal('passwordModal');
}

// Handle avatar upload
function handleAvatarUpload(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = function(e) {
        currentUser.avatar = e.target.result;
        
        // Update profile avatar
        const profileAvatar = document.getElementById('profileAvatar');
        profileAvatar.style.backgroundImage = `url(${e.target.result})`;
        profileAvatar.style.backgroundSize = 'cover';
        profileAvatar.textContent = '';
        
        // Update header avatar
        const headerAvatar = document.getElementById('userAvatar');
        headerAvatar.style.backgroundImage = `url(${e.target.result})`;
        headerAvatar.style.backgroundSize = 'cover';
        headerAvatar.textContent = '';
        
        // Save to localStorage
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
    };
    reader.readAsDataURL(file);
}

// Handle profile form submission
function handleProfileSubmit(e) {
    e.preventDefault();
    
    // Update user data
    currentUser.name = document.getElementById('profileName').value;
    currentUser.email = document.getElementById('profileEmail').value;
    currentUser.phone = document.getElementById('profilePhone').value;
    currentUser.address = document.getElementById('profileAddress').value;
    currentUser.gender = document.querySelector('input[name="gender"]:checked').value;
    
    // Update UI
    document.getElementById('userName').textContent = currentUser.name;
    const userAvatar = document.getElementById('userAvatar');
    userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
    
    if (currentUser.avatar) {
        userAvatar.style.backgroundImage = `url(${currentUser.avatar})`;
        userAvatar.style.backgroundSize = 'cover';
        userAvatar.textContent = '';
    }
    
    // Save to localStorage
    localStorage.setItem('currentUser', JSON.stringify(currentUser));
    
    showToast('Profil berhasil diperbarui');
    closeModal('profileModal');
}

// Handle password form submission
function handlePasswordSubmit(e) {
    e.preventDefault();
    
    const oldPassword = document.getElementById('oldPassword').value;
    const newPassword = document.getElementById('newPassword').value;
    const confirmPassword = document.getElementById('confirmNewPassword').value;
    
    // Simple validation
    if (newPassword !== confirmPassword) {
        showToast('Konfirmasi password tidak cocok');
        return;
    }
    
    if (newPassword.length < 6) {
        showToast('Password baru minimal 6 karakter');
        return;
    }
    
    // Update password (in real app, this would be sent to server)
    currentUser.password = newPassword;
    localStorage.setItem('currentUser', JSON.stringify(currentUser));
    
    showToast('Password berhasil diubah');
    closeModal('passwordModal');
    showProfile();
}

// Show toast notification
function showToast(message) {
    const toast = document.createElement('div');
    toast.className = 'toast';
    toast.textContent = message;
    toast.style.position = 'fixed';
    toast.style.bottom = '20px';
    toast.style.left = '50%';
    toast.style.transform = 'translateX(-50%)';
    toast.style.backgroundColor = '#333';
    toast.style.color = 'white';
    toast.style.padding = '12px 24px';
    toast.style.borderRadius = '4px';
    toast.style.zIndex = '1000';
    toast.style.animation = 'fadeInOut 3s';
    
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.remove();
    }, 3000);
}

// Modal functions
function openModal(id) {
    document.getElementById(id).classList.add('show');
}

function closeModal(id) {
    document.getElementById(id).classList.remove('show');
}

// Tab switching
function switchTab(tabId) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
    
    document.querySelector(`.tab[onclick*="${tabId}"]`).classList.add('active');
    document.getElementById(tabId).classList.add('active');
}

// Payment method selection
function selectPayment(method) {
    document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
    const selected = document.getElementById(`payment${capitalize(method)}`).closest('.payment-method');
    selected.classList.add('selected');
    
    document.getElementById('creditCardDetails').style.display = 
        (method === 'credit') ? 'block' : 'none';
}

function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
}

// Checkout functions
function openCheckoutModal() {
    if (!currentUser) {
        openModal('authModal');
        return;
    }
    
    if (cartItems.length === 0) {
        showToast('Keranjang belanja Anda masih kosong');
        return;
    }
    
    // Pre-fill shipping info from profile if available
    if (currentUser.address) {
        document.getElementById('address').value = currentUser.address;
    }
    if (currentUser.phone) {
        document.getElementById('phone').value = currentUser.phone;
    }
    document.getElementById('receiverName').value = currentUser.name;
    
    // Update order summary
    updateOrderSummary();
    
    openModal('paymentModal');
}

// Auth functions
function handleAuthSubmit(e) {
    e.preventDefault();
    
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    
    if (isLoginMode) {
        // Login logic
        const savedUser = localStorage.getItem('registeredUser_' + email);
        if (savedUser) {
            const userData = JSON.parse(savedUser);
            if (userData.password === password) {
                currentUser = userData;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                showUserLoggedIn();
                closeModal('authModal');
                showToast(`Selamat datang, ${currentUser.name}!`);
            } else {
                showToast('Password salah');
            }
        } else {
            showToast('Email tidak terdaftar');
        }
    } else {
        // Register logic
        const fullName = document.getElementById('fullName').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        if (password !== confirmPassword) {
            showToast('Konfirmasi password tidak cocok');
            return;
        }
        
        if (password.length < 6) {
            showToast('Password minimal 6 karakter');
            return;
        }
        
        currentUser = {
            name: fullName,
            email: email,
            password: password,
            phone: '',
            address: '',
            gender: 'male',
            avatar: '',
            orders: [],
            joinDate: new Date()
        };
        
        localStorage.setItem('registeredUser_' + email, JSON.stringify(currentUser));
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        showUserLoggedIn();
        closeModal('authModal');
        showToast(`Selamat datang, ${currentUser.name}! Akun berhasil dibuat.`);
    }
}

function handlePaymentSubmit(e) {
    e.preventDefault();
    
    // Validate form
    const receiverName = document.getElementById('receiverName').value;
    const address = document.getElementById('address').value;
    const phone = document.getElementById('phone').value;
    const shippingMethod = document.getElementById('shippingMethod').value;
    const shippingNotes = document.getElementById('shippingNotes').value;
    
    if (!receiverName || !address || !phone || !shippingMethod) {
        showToast('Harap lengkapi semua informasi pengiriman');
        return;
    }
    
    if (!document.querySelector('input[name="payment"]:checked')) {
        showToast('Harap pilih metode pembayaran');
        return;
    }
    
    const selectedShipping = shippingMethods[shippingMethod];
    const courier = shippingMethod.toUpperCase();
    
    // Create order object
    const order = {
        id: Date.now(),
        date: new Date(),
        items: [...cartItems],
        shipping: {
            method: selectedShipping.name,
            cost: selectedShipping.price,
            estimate: selectedShipping.estimate,
            address: address,
            phone: phone,
            notes: shippingNotes
        },
        payment: document.querySelector('input[name="payment"]:checked').value,
        status: 'processing',
        trackingNumber: generateTrackingNumber(courier)
    };
    
    // Save order to user's order history
    if (!currentUser.orders) {
        currentUser.orders = [];
    }
    currentUser.orders.push(order);
    localStorage.setItem('currentUser', JSON.stringify(currentUser));
    
    // Show success message
    document.getElementById('successMessage').style.display = 'block';
    
    // Simulate payment processing
    setTimeout(() => {
        // Clear cart
        cartItems = [];
        updateCart();
        localStorage.removeItem('cartItems');
        
        closeModal('paymentModal');
        switchTab('products');
        
        // Show order confirmation
        showToast(`Pesanan berhasil dibuat!\nNo. Pesanan: #${order.id}\nNo. Resi: ${order.trackingNumber}\nEstimasi: ${order.shipping.estimate}`);
    }, 2000);
}

function switchAuthMode() {
    isLoginMode = !isLoginMode;
    document.getElementById('authTitle').textContent = isLoginMode ? 'Masuk ke Akun Anda' : 'Daftar Akun Baru';
    document.getElementById('authSubtitle').textContent = isLoginMode ? 'Silakan masuk untuk melanjutkan belanja' : 'Buat akun baru untuk mulai belanja';
    document.getElementById('signupFields').style.display = isLoginMode ? 'none' : 'block';
    document.getElementById('confirmPasswordGroup').style.display = isLoginMode ? 'none' : 'block';
    document.getElementById('authButton').textContent = isLoginMode ? 'Masuk' : 'Daftar';
    document.getElementById('switchText').textContent = isLoginMode ? 'Belum punya akun?' : 'Sudah punya akun?';
    document.getElementById('switchLink').textContent = isLoginMode ? 'Daftar sekarang' : 'Masuk di sini';
}

function logout() {
    currentUser = null;
    document.getElementById('userInfo').style.display = 'none';
    document.getElementById('loginBtn').style.display = 'inline-block';
    localStorage.removeItem('currentUser');
    
    // Clear cart
    cartItems = [];
    updateCart();
    localStorage.removeItem('cartItems');
    
    showToast('Anda telah logout');
}
function buyNow() {
    if (!currentProduct) return;
    
    // Clear cart and add current product
    cartItems = [{
        id: currentProduct.id,
        title: currentProduct.title,
        image: currentProduct.images[0], // Simpan gambar produk
        price: currentProduct.price,
        quantity: 1
    }];
    
    updateCart();
    openCheckoutModal();
    showProductList();
    switchTab('cart');
}

// Initialize the app
document.addEventListener('DOMContentLoaded', () => {
    init();
});

// Add CSS for fade animation
const style = document.createElement('style');
style.textContent = `
    @keyframes fadeInOut {
        0% { opacity: 0; transform: translateX(-50%) translateY(20px); }
        10% { opacity: 1; transform: translateX(-50%) translateY(0); }
        90% { opacity: 1; transform: translateX(-50%) translateY(0); }
        100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
    }
`;
document.head.appendChild(style);

</script>
</body>
</html>
